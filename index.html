<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°ç‹å­çš„ä¸–ç•Œ</title>
  <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: 'HarmonyOS Sans', 'PingFang SC', 'Microsoft YaHei', Arial, sans-serif;
        background: var(--bg-gradient, linear-gradient(120deg,#bdb2ff 0%,#a0c4ff 100%));
        color: #232946;
        min-height: 100vh;
        box-sizing: border-box;
      }
      body {
  background: linear-gradient(135deg, #232946 0%, #1a1a2e 100%);
  transition: background 1.2s cubic-bezier(.23,1.02,.32,1);
}
body.bg1 { background: linear-gradient(135deg, #232946 0%, #1a1a2e 100%); }
body.bg2 { background: linear-gradient(120deg, #1e3c72 0%, #2a5298 100%); }
body.bg3 { background: linear-gradient(135deg, #232946 0%, #bdb2ff 100%); }
body.bg4 { background: linear-gradient(120deg, #232946 0%, #a0c4ff 100%); }
body.bg5 { background: linear-gradient(135deg, #232946 0%, #f8b500 100%); }

.header-fixed {
  position: fixed;
  top: 0; left: 0; width: 100vw;
  z-index: 100;
  background: rgba(34, 39, 63, 0.98);
  box-shadow: 0 2px 16px #23294622;
  padding: 14px 0 8px 0;
  backdrop-filter: blur(2px);
  display: flex;
  flex-direction: column;
  align-items: center;
  border-bottom-left-radius: 24px;
  border-bottom-right-radius: 24px;
}
.header-fixed h1 {
  color: #fffbe7;
  font-size: 2.1rem;
  text-align: center;
  margin: 0 0 4px 0;
  letter-spacing: 1px;
}
.header-fixed p {
  color: #fffbe7;
  font-size: 1.08rem;
  text-align: center;
  margin: 0;
}

.container {
        margin: 0 auto;
        margin-top: 90px;
        max-width: 680px;
        width: 98vw;
        min-height: 60vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding: 0 8px 32px 8px;
        box-sizing: border-box;
      }

h2 {
  display: none;
}
#preview {
  display: flex;
  flex-direction: column;
  gap: 0px;
  margin: 0 auto;
  max-width: 100vw;
  width: 100%;
  align-items: center;
}
.timeline {
        width: 100%;
        max-width: 100vw;
        margin: 0 auto;
        background: none;
        border-radius: 0;
        box-shadow: none;
        padding: 0;
        min-height: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        gap: 32px;
      }
.timeline-item {
        width: 100%;
        margin: 0 auto;
        display: flex;
        flex-direction: row;
        align-items: flex-start;
        justify-content: center;
        min-width: 0;
        padding-bottom: 0;
      }
.timeline-dot {
  display: none;
}
.timeline-content {
  margin-left: 0;
  flex: 1;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 0;
}
.timeline-date {
  position: static;
  color: #bdb2ff;
  font-size: 1.18rem;
  font-family: 'Segoe Script', 'Segoe UI', cursive, sans-serif;
  letter-spacing: 1px;
  background: rgba(34,39,63,0.92);
  padding: 2px 16px 2px 8px;
  border-radius: 16px;
  box-shadow: 0 2px 8px #23294622;
  min-width: 90px;
  text-align: left;
  z-index: 3;
  margin-bottom: 8px;
}
.card {
        background: rgba(255,255,255,0.92);
        border-radius: 18px;
        box-shadow: 0 2px 16px #23294622;
        padding: 32px 24px 24px 24px;
        margin: 0 auto 18px auto;
        max-width: 520px;
        width: 98%;
        min-height: 220px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 1.18rem;
        transition: box-shadow 0.2s;
      }
.photo-card, .mood-card {
        width: 100%;
        max-width: 100vw;
        box-sizing: border-box;
        padding: 0 0 18px 0;
        margin: 0 auto 0 auto;
      }
.photo-card img, .photo-card video {
        width: 100%;
        max-width: 100vw;
        border-radius: 14px;
        margin-bottom: 8px;
        object-fit: cover;
      }
.photo-card[style*="grid"] img, .photo-card[style*="grid"] video {
        max-width: 100%;
        aspect-ratio: 1/1;
        min-width: 0;
      }
      @media (max-width: 700px) {
        .timeline { max-width: 100vw; gap: 18px; }
        .timeline-item { padding-bottom: 0; }
        .photo-card, .mood-card { max-width: 100vw; }
        .photo-card img, .photo-card video { max-width: 100vw; }
        .photo-card[style*="grid"] img, .photo-card[style*="grid"] video { max-width: 32vw; }
      }
.stars {
  position: fixed;
  left: 0; top: 0; width: 100vw; height: 100vh;
  pointer-events: none;
  z-index: 0;
}
.star {
  position: absolute;
  width: 2.5px; height: 2.5px;
  background: #fffbe7;
  border-radius: 50%;
  opacity: 0.7;
  animation: twinkle 2.5s infinite ease-in-out;
}
@keyframes twinkle {
  0%,100% { opacity: 0.7; }
  50% { opacity: 0.2; }
}
@media (max-width: 900px) {
  .container { max-width: 99vw; }
  .timeline { max-width: 99vw; }
  .photo-card, .mood-card { max-width: 98vw; }
  .photo-card img { max-width: 94vw; max-height: 52vw; }
  .photo-card .desc, .mood-card .desc { max-width: 94vw; }
}
@media (max-width: 700px) {
  .header-fixed { border-radius: 0; padding: 12px 0 6px 0; }
  .header-fixed h1 { font-size: 1.45rem; }
  .header-fixed p { font-size: 0.98rem; }
  .container { max-width: 100vw; padding: 0 0vw; border-radius: 0; margin-top: 80px; }
  #preview { max-width: 100vw; }
  .timeline { max-width: 100vw; min-height: 220px; }
  .photo-card, .mood-card { max-width: 99vw; padding: 0 0 10px 0; }
  .photo-card img { max-width: 98vw; max-height: 60vw; }
  .photo-card .desc, .mood-card .desc { font-size: 1.05rem; }
}
.day-block {
        width: 100%;
        max-width: 700px;
        margin: 0 auto 38px auto;
        background: none;
        border-radius: 18px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0 0 0 0;
      }
      .day-header {
        width: 100%;
        text-align: left;
        margin-bottom: 8px;
        padding-left: 8px;
      }
      .day-title {
        color: #bdb2ff;
        font-size: 1.13rem;
        font-family: 'Segoe Script', 'Segoe UI', cursive, sans-serif;
        margin-bottom: 2px;
      }
      .day-desc {
        color: #a0c4ff;
        font-size: 1.01rem;
        margin-bottom: 6px;
      }
      .day-carousel {
        width: 100%;
        position: relative;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        min-height: 220px;
      }
      .carousel-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(34,39,63,0.7);
        color: #ffe082;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        font-size: 2rem;
        cursor: pointer;
        z-index: 10;
        opacity: 0.85;
        transition: background 0.2s;
      }
      .carousel-btn.left { left: 0; }
      .carousel-btn.right { right: 0; }
      .carousel-btn:active { background: #bdb2ff; color: #232946; }
      @media (max-width: 700px) {
        .day-block { max-width: 100vw; }
        .day-carousel { min-height: 160px; }
        .carousel-btn { width: 28px; height: 28px; font-size: 1.4rem; }
      }
  </style>
  <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
  <div class="stars" id="stars"></div>
  <!-- å°ç‹å­SVGè£…é¥° -->
  <svg class="nature-decor little-prince" width="120" height="220" viewBox="0 0 120 220" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g>
      <ellipse cx="60" cy="210" rx="38" ry="10" fill="#bdb2ff" opacity="0.18"/>
      <circle cx="60" cy="70" r="38" fill="#ffe082" stroke="#f8b500" stroke-width="2"/>
      <ellipse cx="60" cy="120" rx="32" ry="50" fill="#f8b500"/>
      <ellipse cx="60" cy="120" rx="28" ry="44" fill="#ffe082"/>
      <ellipse cx="60" cy="120" rx="18" ry="30" fill="#fffbe7"/>
      <!-- å¤´å‘ -->
      <ellipse cx="60" cy="55" rx="20" ry="10" fill="#f8b500"/>
      <!-- è„¸éƒ¨ -->
      <ellipse cx="60" cy="75" rx="15" ry="15" fill="#fffbe7"/>
      <!-- çœ¼ç› -->
      <ellipse cx="54" cy="78" rx="2.2" ry="2.2" fill="#232946"/>
      <ellipse cx="66" cy="78" rx="2.2" ry="2.2" fill="#232946"/>
      <!-- å¾®ç¬‘ -->
      <path d="M55 85 Q60 90 65 85" stroke="#232946" stroke-width="1.2" fill="none"/>
      <!-- å›´å·¾ -->
      <rect x="44" y="90" width="32" height="10" rx="5" fill="#bdb2ff"/>
      <rect x="70" y="95" width="18" height="6" rx="3" fill="#bdb2ff" transform="rotate(15 70 95)"/>
      <!-- èº«ä½“ -->
      <rect x="50" y="100" width="20" height="50" rx="10" fill="#a0c4ff"/>
      <!-- æ‰‹è‡‚ -->
      <rect x="30" y="110" width="18" height="6" rx="3" fill="#ffe082" transform="rotate(-20 30 110)"/>
      <rect x="72" y="110" width="18" height="6" rx="3" fill="#ffe082" transform="rotate(20 72 110)"/>
      <!-- è…¿ -->
      <rect x="54" y="150" width="6" height="30" rx="3" fill="#bdb2ff"/>
      <rect x="60" y="150" width="6" height="30" rx="3" fill="#bdb2ff"/>
    </g>
  </svg>
  <!-- è‡ªç„¶è£…é¥°SVG -->
  <svg class="nature-decor nature-leaf" width="160" height="120" viewBox="0 0 160 120" fill="none" xmlns="http://www.w3.org/2000/svg">
    <ellipse cx="80" cy="60" rx="80" ry="60" fill="#a5d6a7"/>
    <path d="M80 60 Q100 20 140 40 Q120 80 80 60 Z" fill="#66bb6a"/>
  </svg>
  <svg class="nature-decor nature-cloud" width="200" height="90" viewBox="0 0 200 90" fill="none" xmlns="http://www.w3.org/2000/svg">
    <ellipse cx="60" cy="60" rx="60" ry="30" fill="#b3e5fc"/>
    <ellipse cx="120" cy="50" rx="50" ry="25" fill="#b3e5fc"/>
    <ellipse cx="170" cy="70" rx="30" ry="15" fill="#b3e5fc"/>
  </svg>
</head>
<body>
    <div class="header-fixed" style="position:fixed;top:0;left:0;width:100vw;z-index:100;background:rgba(34,39,63,0.98);box-shadow:0 2px 16px #23294622;padding:14px 0 8px 0;backdrop-filter:blur(2px);">
      <h1 style="margin-bottom:4px;font-size:2.1rem;letter-spacing:1px;">å°ç‹å­çš„ä¸–ç•Œ</h1>
      <p style="margin:0;font-size:1.08rem;color:#fffbe7;">æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººåšå®¢ï¼è¿™é‡Œä½ å¯ä»¥æµè§ˆæˆ‘åˆ†äº«çš„ç…§ç‰‡å’Œå¿ƒæƒ…ã€‚<br>â€œæ‰€æœ‰çš„å¤§äººéƒ½æ›¾ç»æ˜¯å°å­©ï¼Œè™½ç„¶ï¼Œåªæœ‰å°‘æ•°çš„äººè®°å¾—ã€‚â€</p>
    </div>
    <div class="container" style="margin-top:90px;">
      <h2 style="display:none">æˆ‘çš„ç…§ç‰‡åˆ†äº«</h2>
      <div id="preview">
        <div class="timeline" id="timeline" style="width:100%;cursor:pointer;"></div>
      </div>
    </div>
    <!-- èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ -->
    <button id="musicToggle" title="éŸ³ä¹å¼€å…³" style="position:fixed;top:24px;right:32px;z-index:120;background:none;border:none;outline:none;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;">
      <svg id="icon-music-on" width="36" height="36" viewBox="0 0 36 36" fill="none" style="display:block;"><circle cx="18" cy="18" r="17" fill="#bdb2ff" opacity="0.22"/><path d="M10 22h4l6 5V9l-6 5h-4v8z" fill="#a0c4ff" stroke="#232946" stroke-width="1.5"/><path d="M25 13c1.5 1.5 1.5 8.5 0 10" stroke="#232946" stroke-width="2" fill="none"/></svg>
      <svg id="icon-music-off" width="36" height="36" viewBox="0 0 36 36" fill="none" style="display:none;"><circle cx="18" cy="18" r="17" fill="#bdb2ff" opacity="0.22"/><path d="M10 22h4l6 5V9l-6 5h-4v8z" fill="#a0c4ff" stroke="#232946" stroke-width="1.5"/><line x1="12" y1="12" x2="24" y2="24" stroke="#ff5252" stroke-width="2.5"/></svg>
    </button>
    <select id="musicSelect" title="é€‰æ‹©èƒŒæ™¯éŸ³ä¹" style="position:fixed;top:26px;right:80px;z-index:120;background:rgba(34,39,63,0.92);color:#ffe082;border-radius:8px;border:none;padding:2px 8px;font-size:1rem;outline:none;box-shadow:0 2px 8px #23294622;">
      <option value="https://lzhimagebed.xyz/%E4%B9%B0%E8%BE%A3%E6%A4%92%E4%B9%9F%E7%94%A8%E5%88%B8%20-%20%E8%B5%B7%E9%A3%8E%E4%BA%86.mp3">èµ·é£äº† - ä¹°è¾£æ¤’ä¹Ÿç”¨åˆ¸</option>
      <option value="https://lzhimagebed.xyz/%E9%99%88%E5%A5%95%E8%BF%85%20-%20%E6%B7%98%E6%B1%B0.mp3">æ·˜æ±° - é™ˆå¥•è¿…</option>
      <option value="https://lzhimagebed.xyz/%E5%91%A8%E6%9D%B0%E4%BC%A6%20-%20%E6%9C%AA%E5%91%BD%E5%90%8D%E7%9A%84%E6%AD%8C.mp3">æœªå‘½åçš„æ­Œ - å‘¨æ°ä¼¦</option>
      <option value="https://lzhimagebed.xyz/%E7%BA%A2%E6%9F%B3%E6%B1%9F%E5%8D%97%20-%20%E6%99%9A%E9%A3%8E%E6%9B%B2.mp3">æ™šé£æ›²ï¼ˆçº¯éŸ³ä¹ï¼‰- çº¢æŸ³æ±Ÿå—</option>
    </select>
    <audio id="bgm" src="https://lzhimagebed.xyz/%E4%B9%B0%E8%BE%A3%E6%A4%92%E4%B9%9F%E7%94%A8%E5%88%B8%20-%20%E8%B5%B7%E9%A3%8E%E4%BA%86.mp3" loop preload="auto" style="display:none" autoplay></audio>
    <div class="stars" id="stars"></div>
    <svg class="nature-decor little-prince" width="120" height="220" viewBox="0 0 120 220" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g>
        <ellipse cx="60" cy="210" rx="38" ry="10" fill="#bdb2ff" opacity="0.18"/>
        <circle cx="60" cy="70" r="38" fill="#ffe082" stroke="#f8b500" stroke-width="2"/>
    <ellipse cx="170" cy="70" rx="30" ry="15" fill="#b3e5fc"/>
  </svg>
</head>
<body>
    <div class="header-fixed" style="position:fixed;top:0;left:0;width:100vw;z-index:100;background:rgba(34,39,63,0.98);box-shadow:0 2px 16px #23294622;padding:14px 0 8px 0;backdrop-filter:blur(2px);">
      <h1 style="margin-bottom:4px;font-size:2.1rem;letter-spacing:1px;">å°ç‹å­çš„ä¸–ç•Œ</h1>
      <p style="margin:0;font-size:1.08rem;color:#fffbe7;">æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººåšå®¢ï¼è¿™é‡Œä½ å¯ä»¥æµè§ˆæˆ‘åˆ†äº«çš„ç…§ç‰‡å’Œå¿ƒæƒ…ã€‚<br>â€œæ‰€æœ‰çš„å¤§äººéƒ½æ›¾ç»æ˜¯å°å­©ï¼Œè™½ç„¶ï¼Œåªæœ‰å°‘æ•°çš„äººè®°å¾—ã€‚â€</p>
    </div>
    <div class="container" style="margin-top:90px;">
      <h2 style="display:none">æˆ‘çš„ç…§ç‰‡åˆ†äº«</h2>
      <div id="preview">
        <div class="timeline" id="timeline" style="width:100%;cursor:pointer;"></div>
      </div>
    </div>
    <!-- èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ -->
    <button id="musicToggle" title="éŸ³ä¹å¼€å…³" style="position:fixed;top:24px;right:32px;z-index:120;background:none;border:none;outline:none;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;">
      <svg id="icon-music-on" width="36" height="36" viewBox="0 0 36 36" fill="none" style="display:block;"><circle cx="18" cy="18" r="17" fill="#bdb2ff" opacity="0.22"/><path d="M10 22h4l6 5V9l-6 5h-4v8z" fill="#a0c4ff" stroke="#232946" stroke-width="1.5"/><path d="M25 13c1.5 1.5 1.5 8.5 0 10" stroke="#232946" stroke-width="2" fill="none"/></svg>
      <svg id="icon-music-off" width="36" height="36" viewBox="0 0 36 36" fill="none" style="display:none;"><circle cx="18" cy="18" r="17" fill="#bdb2ff" opacity="0.22"/><path d="M10 22h4l6 5V9l-6 5h-4v8z" fill="#a0c4ff" stroke="#232946" stroke-width="1.5"/><line x1="12" y1="12" x2="24" y2="24" stroke="#ff5252" stroke-width="2.5"/></svg>
    </button>
    <select id="musicSelect" title="é€‰æ‹©èƒŒæ™¯éŸ³ä¹" style="position:fixed;top:26px;right:80px;z-index:120;background:rgba(34,39,63,0.92);color:#ffe082;border-radius:8px;border:none;padding:2px 8px;font-size:1rem;outline:none;box-shadow:0 2px 8px #23294622;">
      <option value="https://lzhimagebed.xyz/%E4%B9%B0%E8%BE%A3%E6%A4%92%E4%B9%9F%E7%94%A8%E5%88%B8%20-%20%E8%B5%B7%E9%A3%8E%E4%BA%86.mp3">èµ·é£äº† - ä¹°è¾£æ¤’ä¹Ÿç”¨åˆ¸</option>
      <option value="https://lzhimagebed.xyz/%E9%99%88%E5%A5%95%E8%BF%85%20-%20%E6%B7%98%E6%B1%B0.mp3">æ·˜æ±° - é™ˆå¥•è¿…</option>
      <option value="https://lzhimagebed.xyz/%E5%91%A8%E6%9D%B0%E4%BC%A6%20-%20%E6%9C%AA%E5%91%BD%E5%90%8D%E7%9A%84%E6%AD%8C.mp3">æœªå‘½åçš„æ­Œ - å‘¨æ°ä¼¦</option>
      <option value="https://lzhimagebed.xyz/%E7%BA%A2%E6%9F%B3%E6%B1%9F%E5%8D%97%20-%20%E6%99%9A%E9%A3%8E%E6%9B%B2.mp3">æ™šé£æ›²ï¼ˆçº¯éŸ³ä¹ï¼‰- çº¢æŸ³æ±Ÿå—</option>
    </select>
    <audio id="bgm" src="https://lzhimagebed.xyz/%E4%B9%B0%E8%BE%A3%E6%A4%92%E4%B9%9F%E7%94%A8%E5%88%B8%20-%20%E8%B5%B7%E9%A3%8E%E4%BA%86.mp3" loop preload="auto" style="display:none" autoplay></audio>
    <div class="stars" id="stars"></div>
    <svg class="nature-decor little-prince" width="120" height="220" viewBox="0 0 120 220" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g>
        <ellipse cx="60" cy="210" rx="38" ry="10" fill="#bdb2ff" opacity="0.18"/>
        <circle cx="60" cy="70" r="38" fill="#ffe082" stroke="#f8b500" stroke-width="2"/>
        <ellipse cx="60" cy="120" rx="32" ry="50" fill="#f8b500"/>
        <ellipse cx="60" cy="120" rx="28" ry="44" fill="#ffe082"/>
        <ellipse cx="60" cy="120" rx="18" ry="30" fill="#fffbe7"/>
        <ellipse cx="60" cy="55" rx="20" ry="10" fill="#f8b500"/>
        <ellipse cx="60" cy="75" rx="15" ry="15" fill="#fffbe7"/>
        <ellipse cx="54" cy="78" rx="2.2" ry="2.2" fill="#232946"/>
        <ellipse cx="66" cy="78" rx="2.2" ry="2.2" fill="#232946"/>
        <path d="M55 85 Q60 90 65 85" stroke="#232946" stroke-width="1.2" fill="none"/>
        <rect x="44" y="90" width="32" height="10" rx="5" fill="#bdb2ff"/>
        <rect x="70" y="95" width="18" height="6" rx="3" fill="#bdb2ff" transform="rotate(15 70 95)"/>
        <rect x="50" y="100" width="20" height="50" rx="10" fill="#a0c4ff"/>
        <rect x="30" y="110" width="18" height="6" rx="3" fill="#ffe082" transform="rotate(-20 30 110)"/>
        <rect x="72" y="110" width="18" height="6" rx="3" fill="#ffe082" transform="rotate(20 72 110)"/>
        <rect x="54" y="150" width="6" height="30" rx="3" fill="#bdb2ff"/>
        <rect x="60" y="150" width="6" height="30" rx="3" fill="#bdb2ff"/>
      </g>
    </svg>
    <svg class="nature-decor nature-leaf" width="160" height="120" viewBox="0 0 160 120" fill="none" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="80" cy="60" rx="80" ry="60" fill="#a5d6a7"/>
      <path d="M80 60 Q100 20 140 40 Q120 80 80 60 Z" fill="#66bb6a"/>
    </svg>
    <svg class="nature-decor nature-cloud" width="200" height="90" viewBox="0 0 200 90" fill="none" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="60" cy="60" rx="60" ry="30" fill="#b3e5fc"/>
      <ellipse cx="120" cy="50" rx="50" ry="25" fill="#b3e5fc"/>
      <ellipse cx="170" cy="70" rx="30" ry="15" fill="#b3e5fc"/>
    </svg>
  </div>
  <!-- ç®€å•èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ï¼Œå¸¦å–‡å­æŒ‰é’®å¯å¼€å…³ -->
<button id="bgmToggle" style="position:fixed;right:24px;top:24px;z-index:99;background:#232946;border:none;border-radius:50%;width:48px;height:48px;box-shadow:0 2px 12px #23294644;display:flex;align-items:center;justify-content:center;cursor:pointer;">
  <span id="bgmIcon" style="font-size:2rem;color:#a0c4ff;">ğŸ”Š</span>
</button>
<audio id="bgm" src="https://cdn.jsdelivr.net/gh/skyoflw/assets/audio/relax-piano.mp3" loop style="display:none;"></audio>
<style>
/* è§†é¢‘æ”¾å¤§ï¼Œé€‚é…ç§»åŠ¨ç«¯ */
.photo-card video {
  max-width: 98vw;
  max-height: 340px;
  width: 100%;
  border-radius: 18px;
  background: #f1f8e9;
  margin-bottom: 12px;
  box-shadow: 0 2px 16px rgba(255,193,7,0.10);
  border: 2px solid #a0c4ff;
}
@media (max-width: 700px) {
  .photo-card video {
    max-width: 98vw;
    max-height: 48vw;
  }
}
/* è½®æ’­åˆ‡æ¢æ·¡å…¥æ·¡å‡ºåŠ¨ç”» */
.day-carousel .timeline-content {
  opacity: 1;
  transition: opacity 0.45s cubic-bezier(.23,1.02,.32,1);
}
.day-carousel .timeline-content.fade-out {
  opacity: 0;
}
.day-carousel .timeline-content.fade-in {
  opacity: 1;
}
</style>
<script>
  // æ˜Ÿç©ºèƒŒæ™¯ç”Ÿæˆ
  (function(){
    const starCount = 80;
    const stars = document.getElementById('stars');
    for(let i=0;i<starCount;i++){
      const s = document.createElement('div');
      s.className = 'star';
      s.style.left = Math.random()*100+'vw';
      s.style.top = Math.random()*100+'vh';
      s.style.animationDelay = (Math.random()*2.5)+'s';
      stars.appendChild(s);
    }
  })();

  // åˆ†é¡µå‚æ•°
  let currentIndex = 0;
  let allPhotos = [];
  // è‡ªåŠ¨åŠ è½½ desc.json å¹¶æ¸²æŸ“ï¼šæ—¥æœŸåˆ†åŒºä¸Šä¸‹æ»šåŠ¨ï¼Œæ¯å¤©å†…å·¦å³åˆ‡æ¢
  async function loadPhotos() {
  const timeline = document.getElementById('timeline');
  timeline.innerHTML = '';
  try {
    const resp = await fetch('desc.json');
    if (!resp.ok) throw new Error('desc.json åŠ è½½å¤±è´¥');
    const data = await resp.json();
    let days = [];
    if (Array.isArray(data.days)) {
      days = data.days.slice().sort((a, b) => (b.date > a.date ? 1 : -1)); // æœ€æ–°æ—¥æœŸåœ¨å‰
    } else {
      throw new Error('desc.json æ ¼å¼é”™è¯¯');
    }
    days.forEach(day => {
      const dayBlock = document.createElement('div');
      dayBlock.className = 'day-block';
      // æ—¥æœŸã€æ ‡é¢˜ã€æè¿°
      const dayHeader = document.createElement('div');
      dayHeader.className = 'day-header';
      dayHeader.innerHTML = `<div class='timeline-date'>${formatDate(day.date)}</div>`;
      if(day.title) dayHeader.innerHTML += `<div class='day-title'>${day.title}</div>`;
      if(day.desc) dayHeader.innerHTML += `<div class='day-desc'>${day.desc}</div>`;
      dayBlock.appendChild(dayHeader);
      // è½®æ’­åŒº
      const items = Array.isArray(day.items) ? day.items : [];
      let itemIdx = 0;
      const carousel = document.createElement('div');
      carousel.className = 'day-carousel';
      function renderCarousel(direction) {
        carousel.innerHTML = '';
        if(items.length === 0) return;
        const item = items[itemIdx];
        const content = document.createElement('div');
        content.className = 'timeline-content';
        // å¤šå›¾/å¤šè§†é¢‘å®«æ ¼å±•ç¤º
        if(Array.isArray(item.src) && item.src.length > 0) {
          card = document.createElement('div');
          card.className = 'photo-card';
          card.style.display = 'grid';
          let count = item.src.length;
          let cols = count === 2 ? 2 : count === 4 ? 2 : count >= 3 ? 3 : 1;
          card.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
          card.style.gap = '6px';
          card.style.justifyItems = 'center';
          item.src.forEach(function(url) {
            if(/\.(mp4|webm|ogg)$/i.test(url)) {
              const video = document.createElement('video');
              video.src = url;
              video.controls = true;
              video.style.width = '100%';
              video.style.maxWidth = '120px';
              video.style.borderRadius = '10px';
              video.style.background = '#232946';
              card.appendChild(video);
            } else {
              const img = document.createElement('img');
              img.src = url;
              img.alt = item.desc || '';
              img.loading = 'lazy';
              img.style.width = '100%';
              img.style.maxWidth = '120px';
              img.style.borderRadius = '10px';
              img.style.background = '#232946';
              img.style.objectFit = 'cover';
              card.appendChild(img);
            }
          });
        } else if(item.type === 'image' || (!item.type && item.src && /\.(jpg|jpeg|png|gif|webp)$/i.test(item.src))) {
          card = document.createElement('div');
          card.className = 'photo-card';
          const img = document.createElement('img');
          img.src = item.src;
          img.alt = item.desc || '';
          img.loading = 'lazy';
          card.appendChild(img);
        } else if(item.type === 'video' || (item.src && /\.(mp4|webm|ogg)$/i.test(item.src))) {
          card = document.createElement('div');
          card.className = 'photo-card';
          const video = document.createElement('video');
          video.src = item.src;
          video.controls = true;
          video.style.maxWidth = '180px';
          video.style.maxHeight = '180px';
          video.style.borderRadius = '18px';
          video.style.background = '#f1f8e9';
          card.appendChild(video);
        } else if(item.type === 'text' && !item.src) {
          card = document.createElement('div');
          card.className = 'mood-card';
        } else {
          card = document.createElement('div');
          card.className = 'photo-card';
        }
        if(item.desc) {
          const desc = document.createElement('div');
          desc.className = 'desc';
          desc.textContent = item.desc;
          card.appendChild(desc);
        }
        // å¯é€‰ï¼šæ˜¾ç¤º tags
        if(item.tags && item.tags.length) {
          const tags = document.createElement('div');
          tags.style.cssText = 'margin-top:4px;color:#ffe082;font-size:0.98rem;';
          tags.textContent = '#' + item.tags.join(' #');
          card.appendChild(tags);
        }
        content.appendChild(card);
        carousel.appendChild(content);
        // å·¦å³æŒ‰é’®
        if(items.length > 1) {
          const leftBtn = document.createElement('button');
          leftBtn.className = 'carousel-btn left';
          leftBtn.innerHTML = 'â€¹';
          leftBtn.onclick = e => {
            e.stopPropagation();
            animateCarousel(-1);
          };
          carousel.appendChild(leftBtn);
          const rightBtn = document.createElement('button');
          rightBtn.className = 'carousel-btn right';
          rightBtn.innerHTML = 'â€º';
          rightBtn.onclick = e => {
            e.stopPropagation();
            animateCarousel(1);
          };
          carousel.appendChild(rightBtn);
        }
        // åŠ¨ç”»å¤„ç†
        if(direction) {
          content.classList.add('fade-in');
          setTimeout(()=>{
            content.classList.remove('fade-in');
          }, 450);
        }
      }
      // åˆ‡æ¢åŠ¨ç”»é€»è¾‘
      function animateCarousel(dir) {
        const oldContent = carousel.querySelector('.timeline-content');
        if(oldContent) {
          oldContent.classList.add('fade-out');
          setTimeout(()=>{
            itemIdx = (itemIdx+dir+items.length)%items.length;
            renderCarousel(dir>0?1:-1);
          }, 350);
        } else {
          itemIdx = (itemIdx+dir+items.length)%items.length;
          renderCarousel(dir>0?1:-1);
        }
      }
      renderCarousel();
      dayBlock.appendChild(carousel);
      timeline.appendChild(dayBlock);
    });
  } catch (e) {
    timeline.innerHTML = '<div style="color:#c00;text-align:center;width:100%">æ— æ³•åŠ è½½ desc.jsonï¼Œ<br>è¯·ç¡®ä¿é€šè¿‡æœ¬åœ°æœåŠ¡å™¨è®¿é—®ï¼ˆå¦‚ VSCode Live Serverã€Python SimpleHTTPServer ç­‰ï¼‰ï¼Œå¦åˆ™æµè§ˆå™¨å®‰å…¨ç­–ç•¥ä¼šé˜»æ­¢è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚<br>é”™è¯¯ä¿¡æ¯ï¼š'+e.message+'</div>';
  }
}
  // ä¿®å¤èƒŒæ™¯éŸ³ä¹åªèƒ½æœ‰ä¸€é¦–æ’­æ”¾ï¼Œåˆ‡æ¢éŸ³ä¹æ—¶å…ˆæš‚åœå†åˆ‡æ¢src
const audio = document.getElementById('bgm');
const musicSelect = document.getElementById('musicSelect');
const musicToggle = document.getElementById('musicToggle');
const iconMusicOn = document.getElementById('icon-music-on');
const iconMusicOff = document.getElementById('icon-music-off');

function updateMusicIcon() {
  if(audio && !audio.paused) {
    iconMusicOn.style.display = 'block';
    iconMusicOff.style.display = 'none';
  } else {
    iconMusicOn.style.display = 'none';
    iconMusicOff.style.display = 'block';
  }
}

musicToggle.addEventListener('click', function(){
  if(audio.paused) {
    audio.play().catch(()=>{});
  } else {
    audio.pause();
  }
  updateMusicIcon();
});

audio.addEventListener('play', updateMusicIcon);
audio.addEventListener('pause', updateMusicIcon);

musicSelect.addEventListener('change', function() {
  audio.pause();
  audio.currentTime = 0;
  audio.src = this.value;
  audio.load();
  audio.play().catch(()=>{});
  updateMusicIcon();
});

  // æ–°å¢ï¼šæ ¼å¼åŒ–æ—¥æœŸå‡½æ•°
  function formatDate(dateStr) {
    if(!dateStr) return '';
    const d = new Date(dateStr);
    if(isNaN(d)) return dateStr;
    return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0');
  }
  // è‡ªåŠ¨åˆ‡æ¢èƒŒæ™¯
  const bgList = ['bg1','bg2','bg3','bg4','bg5'];
  let bgIdx = 0;
  function switchBg() {
    document.body.classList.remove(...bgList);
    document.body.classList.add(bgList[bgIdx]);
    bgIdx = (bgIdx + 1) % bgList.length;
  }
  switchBg();
  setInterval(switchBg, 12000); // æ¯12ç§’åˆ‡æ¢ä¸€æ¬¡

  // éŸ³ä¹é€‰æ‹©ä¸‹æ‹‰æ¡†é€»è¾‘
  musicSelect = document.getElementById('musicSelect');
  musicSelect.addEventListener('change', function() {
    const audio = document.getElementById('bgm');
    audio.src = this.value;
    audio.play().catch(function(){});
    updateMusicIcon();
  });
  // éŸ³ä¹é€‰æ‹©åˆ‡æ¢é€»è¾‘
  document.getElementById('musicSelect').addEventListener('change', function(){
    var audio = document.getElementById('bgm');
    var url = this.value;
    var wasPlaying = !audio.paused;
    audio.src = url;
    audio.load();
    if(wasPlaying) {
      audio.play().catch(function(){});
    }
    updateMusicIcon();
  });
  // èƒŒæ™¯éŸ³ä¹å–‡å­æŒ‰é’®å¼€å…³
  const bgm = document.getElementById('bgm');
  const bgmToggle = document.getElementById('bgmToggle');
  const bgmIcon = document.getElementById('bgmIcon');
  let bgmPlaying = false;
  function updateBgmIcon() {
    bgmIcon.textContent = bgmPlaying ? 'ğŸ”Š' : 'ğŸ”ˆ';
  }
  bgmToggle.addEventListener('click', function() {
    if(bgmPlaying) {
      bgm.pause();
      bgmPlaying = false;
    } else {
      bgm.play();
      bgmPlaying = true;
    }
    updateBgmIcon();
  });
  // è‡ªåŠ¨åˆ‡æ¢iconçŠ¶æ€
  bgm.addEventListener('play', function(){ bgmPlaying = true; updateBgmIcon(); });
  bgm.addEventListener('pause', function(){ bgmPlaying = false; updateBgmIcon(); });
  // é¡µé¢åŠ è½½åè‡ªåŠ¨æ’­æ”¾ä¸€æ¬¡ï¼ˆéœ€ç”¨æˆ·äº¤äº’åæ‰ç”Ÿæ•ˆï¼‰
  document.body.addEventListener('click', function autoPlayBgm(){
    if(!bgmPlaying){
      bgm.play().catch(()=>{});
    }
    document.body.removeEventListener('click', autoPlayBgm);
  });
  loadPhotos();
  </script>
</body>
</html>
